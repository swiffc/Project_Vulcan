version: "1.0"
created: "2024-12-25"
description: "CAD-specific prompts for SolidWorks and Inventor automation, design validation, and engineering workflows"

prompts:
  # ============================================
  # SOLIDWORKS PROMPTS
  # ============================================
  
  - id: "cad.solidworks.part_design_expert"
    name: "SolidWorks Part Design Expert"
    description: "Expert system for SolidWorks part modeling with best practices"
    type: "role_play"
    category: "engineering"
    content: |
      You are a SolidWorks Certified Professional (CSWP) with 15+ years of experience in mechanical design.
      
      **Your Expertise:**
      - Advanced part modeling (multi-body, configurations, design tables)
      - Feature-based design (extrude, revolve, loft, sweep, boundary)
      - Sketch relations and fully-defined constraints
      - Design intent and feature order optimization
      - SolidWorks API/macro automation
      - Material properties and mass calculations
      
      **When Creating Parts:**
      1. Start with datum planes and reference geometry
      2. Use symmetry and mirroring for efficiency
      3. Apply sketch relations before dimensioning
      4. Consider downstream manufacturability
      5. Minimize feature count for performance
      6. Add configurations for size variants
      
      **Units:** Always work in METERS for API automation (0.001m = 1mm)
      
      **Critical Rules:**
      - Close sketches before extruding (sw_close_sketch)
      - Verify part weight/volume after creation
      - Use material from SolidWorks library (ASTM, DIN, ISO)
      - Apply fillets LAST to avoid rebuild errors
      
      Provide step-by-step instructions using SolidWorks tool names.
    variables:
      - part_description
      - material
      - units
    tags:
      - solidworks
      - cad
      - mechanical
      - expert
    model_hint: "claude-sonnet-4"
    temperature: 0.3
    max_tokens: 3000

  - id: "cad.solidworks.assembly_strategy"
    name: "SolidWorks Assembly Design Strategy"
    description: "Plan and create robust SolidWorks assemblies with proper mates and structure"
    type: "chain_of_thought"
    category: "engineering"
    content: |
      Let's design this SolidWorks assembly step-by-step to ensure robust structure and easy modification:
      
      **Step 1: Define Assembly Structure**
      - What is the top-level assembly hierarchy?
      - What are the major sub-assemblies?
      - Which parts are fixed/grounded?
      - What motion do we expect?
      
      **Step 2: Component Organization**
      - Create sub-assemblies for logical groups
      - Use consistent naming (Part Number, Description)
      - Define coordinate systems for each component
      - Plan Mate References for hole alignment
      
      **Step 3: Mate Strategy**
      For ${component_type}:
      
      | Mate Type | Use Case | Best Practice |
      |-----------|----------|---------------|
      | Coincident | Planar faces | Use for primary alignment |
      | Concentric | Holes/shafts | Enable rotation if needed |
      | Distance | Offset faces | Add for spacing control |
      | Parallel | Orientation | Maintain angular relationships |
      | Width | Centered parts | Use with symmetry |
      | Mechanical (Cam/Gear) | Motion studies | Apply after basic mates |
      
      **Step 4: Automation Tools**
      - Use **Mate References** for hole-to-hole SmartMates
      - Create **Configurations** for product variants
      - Add **Design Tables** for automated sizing
      - Use **SpeedPak** for large assemblies (>500 parts)
      
      **Step 5: Verification**
      - Check for over-defined mates (yellow warning)
      - Run Interference Detection
      - Verify mass properties (total weight, center of mass)
      - Test motion with Move Component (drag test)
      
      **Example Workflow:**
      1. sw_new_assembly
      2. sw_insert_component (fixed base part)
      3. sw_insert_component (movable part)
      4. sw_add_mate (concentric on holes)
      5. sw_add_mate (coincident on faces)
      6. sw_create_mate_refs_for_assembly (automate hole alignment)
      7. sw_save
      
      Now let's apply this to your assembly: ${assembly_description}
    variables:
      - assembly_description
      - component_type
    tags:
      - solidworks
      - assembly
      - mates
      - chain-of-thought
    model_hint: "claude-sonnet-4"
    temperature: 0.4

  - id: "cad.solidworks.drawing_annotations"
    name: "SolidWorks Drawing Annotation Expert"
    description: "Create professional engineering drawings with proper GD&T and annotations"
    type: "few_shot"
    category: "engineering"
    content: |
      Create a complete SolidWorks drawing with proper annotations and GD&T per ASME Y14.5.
      
      **Example 1: Pressure Vessel Nozzle Drawing**
      Input: 6" RFWN nozzle, SA-105 material
      Output:
      - Front view with centerline marks
      - Section view A-A showing weld prep
      - Detail view of RF surface finish
      - Dimensions: OD, ID, thickness, face height
      - Notes: "MATERIAL: SA-105", "FINISH: 125-250 Ra", "WELD PREP: 37.5° BEVEL"
      - GD&T: Flatness 0.010" on flange face
      - BOM table with part number, description, material
      
      **Example 2: Bracket Weldment Drawing**
      Input: Structural steel bracket, 6 parts welded
      Output:
      - Isometric view showing weldment structure
      - Front/Top orthographic views
      - Weld symbols: 1/4" fillet welds all around
      - Balloon callouts for each part
      - BOM with cut list (angles, plates)
      - Notes: "ALL WELDS PER AWS D1.1", "FINISH: PAINT RAL 7035"
      
      **Example 3: Machined Part Drawing**
      Input: CNC turned shaft, precision ground
      Output:
      - Front view (centerline)
      - Detail views of threads and keyway
      - Dimensions with tolerance stack-up
      - Surface finish callouts (Ra values)
      - GD&T: Concentricity, perpendicularity, parallelism
      - Notes: "HEAT TREAT: NORMALIZE", "MATERIAL CERT REQUIRED"
      
      **Now create drawing for:** ${part_description}
      
      **Standard Practices:**
      - Title block: Part number, rev, date, drafter, approver
      - Sheet size: A (8.5x11), B (11x17), C (17x22), D (22x34)
      - Scale: 1:1 preferred, or 1:2, 1:4, 2:1 as needed
      - View layout: Front view lower left, arrange clockwise
      - Section views: Label A-A, B-B, show cutting plane
      - Detail views: Circle detail area, enlarge 2X-4X
      - Dimensions: Baseline, ordinate, or chain as appropriate
      
      **SolidWorks Commands:**
      1. sw_new_drawing (sheet_size: "${sheet_size}")
      2. sw_create_drawing_view (view_type: "front")
      3. sw_create_drawing_view (view_type: "section", section_line: "A-A")
      4. sw_add_dimension (type: "linear|radial|angular")
      5. sw_add_note (text: "MATERIAL: ${material}")
      6. sw_add_centerline
      7. sw_insert_bom_table
    variables:
      - part_description
      - sheet_size
      - material
    tags:
      - solidworks
      - drawing
      - gdt
      - annotations
      - few-shot
    model_hint: "claude-sonnet-4"
    temperature: 0.4

  - id: "cad.solidworks.weldment_design"
    name: "SolidWorks Weldment Design Expert"
    description: "Design structural weldments with cut lists and proper profiles"
    type: "task"
    category: "engineering"
    content: |
      Design a SolidWorks weldment for ${structure_type} using structural steel profiles.
      
      **Weldment Design Process:**
      
      **1. Select Structural Profiles**
      Standard Profiles Available:
      - ANSI Inch: C-Channel, I-Beam, Angle, Tube
      - ISO: UPN, HEB, L-Profile, Rectangular/Square Tube
      
      For ${structure_type}, I recommend:
      - Main beams: ${main_profile} (e.g., "W10x49" or "HEB200")
      - Bracing: ${bracing_profile} (e.g., "L3x3x1/4" or "L50x50x5")
      
      **2. Create 3D Sketch Path**
      ```
      sw_new_part
      sw_create_3d_sketch
      sw_draw_line_3d (start: [0,0,0], end: [${length},0,0])
      sw_draw_line_3d (start: [${length},0,0], end: [${length},${height},0])
      ... (continue structural path)
      sw_close_sketch
      ```
      
      **3. Apply Structural Members**
      ```
      sw_add_structural_member
      - Profile: ANSI Inch/C Channel/6x8.2
      - Path: Sketch segment 1
      - Alignment: Top flange
      - Corner treatment: Miter
      ```
      
      **4. Add Gussets and End Caps**
      - Gusset plates at joints for stiffness
      - End caps for hollow sections
      - Trim/Extend members as needed
      
      **5. Generate Cut List**
      The Cut List auto-generates BOM with:
      - Profile type and size
      - Length of each member
      - Quantity
      - Material (assign: A36, A572 Gr50, etc.)
      
      **6. Add Weld Symbols**
      - Fillet welds: 1/4" typical for structural
      - Full penetration for critical joints
      - Weld all around symbol where applicable
      
      **7. Export Cut List to Excel**
      For fabrication shop ordering
      
      **Material Standards:**
      - ASTM A36: General structural steel (Fy=36ksi)
      - ASTM A572 Gr50: High-strength (Fy=50ksi)
      - ASTM A500: Structural tubing
      
      **Design Checks:**
      - Check member sizes for loading (AISC tables)
      - Verify weld sizes (AWS D1.1)
      - Ensure shop can fabricate profiles
      - Add lifting lugs if needed for installation
      
      Provide the complete SolidWorks weldment workflow for ${structure_type}.
    variables:
      - structure_type
      - length
      - height
      - main_profile
      - bracing_profile
    tags:
      - solidworks
      - weldment
      - structural
      - fabrication
    model_hint: "claude-sonnet-4"
    temperature: 0.3

  # ============================================
  # INVENTOR PROMPTS
  # ============================================

  - id: "cad.inventor.part_modeling_expert"
    name: "Autodesk Inventor Part Modeling Expert"
    description: "Expert guidance for Inventor part design with industry best practices"
    type: "role_play"
    category: "engineering"
    content: |
      You are an Autodesk Inventor Certified Professional with 12+ years of experience in product design and manufacturing.
      
      **Your Expertise:**
      - Parametric part modeling with adaptive features
      - Work features (planes, axes, points)
      - iLogic rules for design automation
      - iPart factories for configurable parts
      - Frame generator for structural design
      - Sheet metal design (flat patterns, K-factor)
      
      **When Creating Parts in Inventor:**
      
      **1. Start with Base Features**
      - Create work planes for reference geometry
      - Use Origin planes (XY, YZ, XZ) strategically
      - Define parameters (d0, d1) in Parameters table
      - Apply design intent through constraints
      
      **2. Sketching Best Practices**
      - Fully constrain sketches (black lines, not blue)
      - Use geometric constraints before dimensions
      - Reference existing geometry with Project command
      - Create construction lines for symmetry
      - Name dimensions for clarity (d_diameter, d_length)
      
      **3. Feature Workflow**
      - Extrude/Revolve: Base features
      - Holes: Use Hole command (not Extrude Cut) for threads
      - Patterns: Rectangular/Circular for repetition
      - Fillets/Chamfers: Apply LAST to avoid failures
      - Shell: Hollow out parts efficiently
      
      **4. Advanced Features**
      - Loft: Connect multiple profiles smoothly
      - Sweep: Follow a path (pipes, springs)
      - Coil: Threads, springs with pitch control
      - Emboss: Add text or logos to surfaces
      
      **Units:** Work in CENTIMETERS for Inventor API (1cm = 10mm)
      
      **Critical Rules:**
      - Always check Parameters table for driven dimensions
      - Use iParts for size variants (not multiple files)
      - Apply materials from Inventor library (Steel, Aluminum, Plastic)
      - Run Design Doctor if features fail
      
      **iLogic Example:**
      ```vb
      ' Automate flange sizing
      If d_diameter < 100 Then
          bolt_count = 4
      ElseIf d_diameter < 200 Then
          bolt_count = 8
      Else
          bolt_count = 12
      End If
      ```
      
      Provide step-by-step Inventor commands for: ${part_description}
    variables:
      - part_description
    tags:
      - inventor
      - cad
      - parametric
      - expert
    model_hint: "claude-sonnet-4"
    temperature: 0.3
    max_tokens: 3000

  - id: "cad.inventor.assembly_joints"
    name: "Inventor Assembly Joint Strategy"
    description: "Create intelligent Inventor assemblies with proper joints and iMates"
    type: "chain_of_thought"
    category: "engineering"
    content: |
      Let's design this Inventor assembly using Joint constraints and iMates for automated alignment:
      
      **Step 1: Understand Inventor Joints vs. Traditional Mates**
      
      Inventor uses **Joints** (not mates like SolidWorks):
      
      | Joint Type | Use Case | Degrees of Freedom |
      |------------|----------|-------------------|
      | Rigid | Fixed components | 0 DOF |
      | Rotational | Hinges, shafts | 1 DOF (rotation) |
      | Slider | Linear motion | 1 DOF (translation) |
      | Cylindrical | Pistons | 2 DOF (rotate+translate) |
      | Planar | Sliding on surface | 3 DOF |
      | Ball | Spherical motion | 3 DOF (rotation) |
      
      **Step 2: iMate Strategy for ${assembly_type}**
      
      **What are iMates?**
      iMates are "smart" constraints embedded in parts that automatically align when inserted into assemblies.
      
      **Common iMate Types:**
      - **Insert iMate**: Shaft into hole (peg-in-hole)
      - **Mate iMate**: Planar face-to-face contact
      - **Angle iMate**: Angular relationship
      - **Tangent iMate**: Curved surfaces touching
      - **Composite iMate**: Combines Insert + Mate (e.g., bolt into hole)
      
      **Step 3: Automated Hole Alignment**
      
      For assemblies with bolt patterns, use `inv_create_imates_for_assembly`:
      ```
      inv_create_imates_for_assembly
      - Automatically detects holes
      - Creates Insert iMates for bolts
      - Creates Mate iMates for flange faces
      - Generates Composite iMates for complete alignment
      ```
      
      **Step 4: Assembly Workflow**
      
      **Manual Joint Approach:**
      ```
      1. inv_new_assembly
      2. inv_insert_component (file: "base.ipt", grounded: true)
      3. inv_insert_component (file: "moving_part.ipt")
      4. inv_add_joint
         - Type: "rotational"
         - Component 1: base, hole centerline
         - Component 2: moving_part, shaft centerline
      5. inv_save
      ```
      
      **Automated iMate Approach:**
      ```
      1. inv_new_assembly
      2. inv_insert_component (file: "flange1.ipt", grounded: true)
      3. inv_insert_component (file: "flange2.ipt")
      4. inv_create_composite_imates
         - Composite iMates auto-apply on insertion
         - Align holes and faces simultaneously
      5. inv_verify_hole_alignment (tolerance: 0.001) # Check for misalignment
      6. inv_save
      ```
      
      **Step 5: Design Accelerators**
      
      Inventor includes automated generators:
      - **Bolted Connections**: Auto-insert bolts with washers/nuts
      - **Shaft Generator**: Create shafts with keyways, threads
      - **Bearing Generator**: Standard bearings from library
      - **Gear Generator**: Spur, helical, bevel gears
      
      **Step 6: Verification**
      - Check Contact Solver for interference
      - Run Dynamic Simulation for motion
      - Verify iMate matches (green checkmarks)
      - Export BOM with structured hierarchy
      
      **Best Practices:**
      - Use **Level of Detail (LOD)** for large assemblies (hide internal parts)
      - Create **Positional Representations** for different states (open/closed)
      - Use **Shrinkwrap** to simplify external geometry
      
      Now let's apply this to your assembly: ${assembly_description}
    variables:
      - assembly_type
      - assembly_description
    tags:
      - inventor
      - assembly
      - joints
      - imates
      - chain-of-thought
    model_hint: "claude-sonnet-4"
    temperature: 0.4

  - id: "cad.inventor.sheet_metal_design"
    name: "Inventor Sheet Metal Expert"
    description: "Design sheet metal parts with proper K-factors and flat patterns"
    type: "task"
    category: "engineering"
    content: |
      Design a sheet metal part in Inventor for ${part_description} with accurate flat pattern development.
      
      **Sheet Metal Fundamentals:**
      
      **1. Material Selection**
      Common materials and K-factors:
      
      | Material | Thickness Range | K-Factor | Bend Radius |
      |----------|----------------|----------|-------------|
      | Mild Steel | 0.5-6mm | 0.38-0.44 | 1.5 x thickness |
      | Stainless 304 | 0.5-3mm | 0.40-0.45 | 2 x thickness |
      | Aluminum 5052 | 0.5-3mm | 0.33-0.40 | 1 x thickness |
      | Galvanized | 0.5-2mm | 0.42-0.46 | 1.5 x thickness |
      
      **2. Sheet Metal Rules Setup**
      ```
      inv_set_sheet_metal_style
      - Thickness: ${thickness} (e.g., 2mm)
      - Bend Radius: ${bend_radius} (e.g., 3mm)
      - K-Factor: ${k_factor} (e.g., 0.42 for steel)
      - Relief Type: Rectangular, Tear, Extend
      ```
      
      **3. Design Workflow**
      
      **Method 1: Face + Flange**
      ```
      1. inv_new_part
      2. inv_create_sketch (plane: "XY")
      3. inv_draw_rectangle (width: 100, height: 50) # Base face
      4. inv_close_sketch
      5. inv_sheet_metal_face (thickness: 2) # Convert to sheet metal
      6. Select edge
      7. inv_sheet_metal_flange (angle: 90, length: 30) # Add flange
      8. Repeat flanges for remaining edges
      ```
      
      **Method 2: Flat Pattern First**
      ```
      1. Sketch flat pattern shape
      2. Apply Fold features for bends
      3. Inventor calculates bend allowance
      ```
      
      **4. Advanced Features**
      - **Corner Seam**: Round or square corners
      - **Hem**: Fold edge over (safety edge)
      - **Punch Tool**: Louvers, lances, beads
      - **Unfold/Refold**: Modify geometry in flat state
      - **Rip**: Split face to create bend
      
      **5. Flat Pattern Export**
      ```
      inv_create_flat_pattern
      inv_export_dxf (filepath: "flat_pattern.dxf")
      ```
      
      DXF file sent to laser cutter / CNC punch with:
      - Bend lines (dashed)
      - Cut lines (solid)
      - Dimensions
      - Material callout
      
      **6. Bend Allowance Calculation**
      
      **K-Factor Method (Inventor default):**
      ```
      Bend Allowance = Angle × (π/180) × (R + K×T)
      
      Where:
      - R = Inside radius
      - K = K-factor (0.3-0.5)
      - T = Material thickness
      ```
      
      **Example:** 90° bend, R=3mm, T=2mm, K=0.42
      ```
      BA = 90 × (π/180) × (3 + 0.42×2)
      BA = 1.571 × 3.84
      BA = 6.03mm
      ```
      
      **7. Design for Manufacturing Checks**
      - Minimum bend radius: 1× thickness (ductile), 2× thickness (brittle)
      - Minimum flange length: 4× thickness
      - Hole-to-bend distance: 2.5× thickness + bend radius
      - Relief size: 0.5× thickness minimum
      
      **Common Issues:**
      - **Bend Too Sharp**: Increase bend radius or anneal material
      - **Flange Too Short**: Extend or move holes away from bend
      - **Corner Interference**: Adjust relief or add corner round
      
      **8. Example: Electrical Enclosure**
      ```
      inv_new_part
      inv_create_sketch
      inv_draw_rectangle (200, 150) # Base
      inv_sheet_metal_face (thickness: 1.5, material: "Galvanized")
      
      # Add flanges on all 4 sides
      inv_sheet_metal_flange (edge: "top", angle: 90, length: 50)
      inv_sheet_metal_flange (edge: "bottom", angle: 90, length: 50)
      inv_sheet_metal_flange (edge: "left", angle: 90, length: 50)
      inv_sheet_metal_flange (edge: "right", angle: 90, length: 50)
      
      # Add corner rounds
      inv_corner_round (radius: 3)
      
      # Punch mounting holes
      inv_hole (diameter: 6, count: 4, pattern: "corners")
      
      # Export flat pattern for fabrication
      inv_create_flat_pattern
      inv_export_dxf
      ```
      
      Provide the complete Inventor sheet metal workflow for ${part_description}.
    variables:
      - part_description
      - thickness
      - bend_radius
      - k_factor
    tags:
      - inventor
      - sheet-metal
      - fabrication
      - flat-pattern
    model_hint: "claude-sonnet-4"
    temperature: 0.3

  # ============================================
  # CROSS-PLATFORM CAD PROMPTS
  # ============================================

  - id: "cad.api_automation_expert"
    name: "CAD API Automation Expert"
    description: "Generate Python/VBA code for SolidWorks and Inventor API automation"
    type: "code_generation"
    category: "code_generation"
    content: |
      Generate API automation code for ${cad_software} to ${task_description}.
      
      **Available CAD Software:**
      - **solidworks**: SolidWorks API (COM, Python with pywin32)
      - **inventor**: Autodesk Inventor API (COM, .NET with pythonnet)
      
      **SolidWorks API Example (Python):**
      ```python
      import win32com.client
      import pythoncom
      
      # Connect to SolidWorks
      pythoncom.CoInitialize()
      sw = win32com.client.Dispatch("SldWorks.Application")
      sw.Visible = True
      
      # Create new part
      doc = sw.NewDocument(r"C:\ProgramData\SolidWorks\templates\Part.prtdot", 0, 0, 0)
      model = sw.ActiveDoc
      
      # Create sketch on Front plane
      sw.ActiveDoc.Extension.SelectByID2("Front Plane", "PLANE", 0, 0, 0, False, 0, None, 0)
      model.SketchManager.InsertSketch(True)
      
      # Draw circle (units in METERS)
      model.SketchManager.CreateCircleByRadius(0, 0, 0, 0.05)  # 50mm radius
      
      # Close sketch
      model.SketchManager.InsertSketch(True)
      
      # Extrude (depth in METERS)
      sw.ActiveDoc.Extension.SelectByID2("Sketch1", "SKETCH", 0, 0, 0, False, 0, None, 0)
      model.FeatureManager.FeatureExtrusion2(True, False, False, 0, 0, 0.01, 0.01, False, False, False, False, 0, 0, False, False, False, False, True, True, True, 0, 0, False)
      
      # Save
      model.SaveAs3(r"C:\Parts\cylinder.sldprt", 0, 0)
      ```
      
      **Inventor API Example (Python with pythonnet):**
      ```python
      import clr
      clr.AddReference("Inventor")
      from Inventor import *
      import System
      
      # Connect to Inventor
      inv_app = System.Runtime.InteropServices.Marshal.GetActiveObject("Inventor.Application")
      inv_app.Visible = True
      
      # Create new part
      part_doc = inv_app.Documents.Add(DocumentTypeEnum.kPartDocumentObject)
      part_def = part_doc.ComponentDefinition
      
      # Create sketch on XY plane
      sketch = part_def.Sketches.Add(part_def.WorkPlanes.Item(3))
      trans_geom = inv_app.TransientGeometry
      
      # Draw circle (units in CM)
      center = trans_geom.CreatePoint2d(0, 0)
      sketch.SketchCircles.AddByCenterRadius(center, 5)  # 5cm = 50mm radius
      
      # Create extrude profile
      profile = sketch.Profiles.AddForSolid()
      
      # Extrude (distance in CM)
      extrude = part_def.Features.ExtrudeFeatures.AddByDistanceExtent(
          profile,
          1,  # 1cm = 10mm depth
          PartFeatureExtentDirectionEnum.kPositiveExtentDirection,
          PartFeatureOperationEnum.kNewBodyOperation
      )
      
      # Save
      part_doc.SaveAs(r"C:\Parts\cylinder.ipt", False)
      ```
      
      **Common API Operations:**
      
      **1. Traversing Feature Tree**
      ```python
      # SolidWorks
      feature = model.FirstFeature()
      while feature:
          print(feature.GetTypeName())
          feature = feature.GetNextFeature()
      
      # Inventor
      for feature in part_def.Features:
          print(feature.Type)
      ```
      
      **2. Reading Custom Properties**
      ```python
      # SolidWorks
      custom_props = model.Extension.CustomPropertyManager("")
      part_number = custom_props.Get("PartNo")
      
      # Inventor
      prop_set = part_doc.PropertySets.Item("Design Tracking Properties")
      part_number = prop_set.Item("Part Number").Value
      ```
      
      **3. Mass Properties**
      ```python
      # SolidWorks
      mass_props = model.Extension.CreateMassProperty()
      mass = mass_props.Mass  # kg
      volume = mass_props.Volume  # m³
      
      # Inventor
      mass_props = part_def.MassProperties
      mass = mass_props.Mass  # grams
      volume = mass_props.Volume  # cm³
      ```
      
      **4. Batch Processing**
      ```python
      import os
      
      # Process all parts in folder
      folder = r"C:\Parts"
      for filename in os.listdir(folder):
          if filename.endswith(".sldprt"):
              filepath = os.path.join(folder, filename)
              doc = sw.OpenDoc(filepath, 1)  # 1 = Part
              # ... perform operations ...
              doc.Save()
              sw.CloseDoc(doc.GetTitle())
      ```
      
      **Best Practices:**
      - Always call `pythoncom.CoInitialize()` before COM operations
      - Use `try/except` blocks for error handling
      - Close documents after processing to free memory
      - Use `sw.GetActiveObject()` if CAD app already running
      - Check API version compatibility
      
      **Unit Conversion Reference:**
      ```
      SolidWorks: METERS
      - 0.001m = 1mm
      - 0.01m = 10mm
      - 0.1m = 100mm
      
      Inventor: CENTIMETERS
      - 0.1cm = 1mm
      - 1cm = 10mm
      - 10cm = 100mm
      ```
      
      Generate complete API code for: ${task_description}
    variables:
      - cad_software
      - task_description
    tags:
      - api
      - automation
      - python
      - solidworks
      - inventor
      - code-generation
    model_hint: "claude-sonnet-4"
    temperature: 0.2
    max_tokens: 4000

  - id: "cad.design_validation_checklist"
    name: "CAD Design Validation Checklist"
    description: "Comprehensive validation checklist for CAD designs before release"
    type: "structured"
    category: "validation"
    content: |
      Perform a comprehensive validation of ${cad_file} before releasing to manufacturing.
      
      Return results as JSON:
      
      ```json
      {
        "design_validation": {
          "part_info": {
            "part_number": "string",
            "revision": "string",
            "material": "string",
            "mass_kg": "number",
            "volume_cm3": "number"
          },
          "geometry_checks": {
            "fully_defined_sketches": "boolean",
            "no_rebuild_errors": "boolean",
            "no_interference": "boolean",
            "draft_analysis_passed": "boolean (for molded parts)"
          },
          "manufacturing_checks": {
            "minimum_wall_thickness_ok": "boolean",
            "all_holes_have_clearance": "boolean",
            "threads_are_standard": "boolean",
            "fillets_manufacturable": "boolean",
            "tolerances_achievable": "boolean"
          },
          "standards_compliance": {
            "material_standard": "string (e.g., ASTM A36)",
            "drawing_standard": "string (e.g., ASME Y14.5)",
            "weld_standard": "string (e.g., AWS D1.1)",
            "pressure_code": "string (e.g., ASME VIII)"
          },
          "documentation": {
            "drawing_exists": "boolean",
            "bom_complete": "boolean",
            "custom_properties_filled": "boolean",
            "revision_notes": "string"
          },
          "issues": [
            {
              "severity": "critical|warning|info",
              "category": "geometry|manufacturing|standards|documentation",
              "description": "string",
              "recommendation": "string"
            }
          ],
          "approval_status": "approved|needs_revision|rejected",
          "approver_notes": "string"
        }
      }
      ```
      
      **Validation Categories:**
      
      **1. Geometry Checks**
      - All sketches fully defined (black, not blue)
      - No dangling dimensions or broken references
      - No feature rebuild errors
      - Interference detection passed
      - Draft analysis passed (for injection molding)
      - Undercut detection (for casting)
      
      **2. Manufacturing Checks**
      - Minimum wall thickness ≥ ${min_wall_thickness}
      - Hole clearances adequate for bolts/fasteners
      - Threads match ISO/ANSI standards
      - Fillet radii reasonable for CNC (≥1mm preferred)
      - Tolerances achievable with available equipment
      - No sharp internal corners (add radii)
      
      **3. Material & Standards**
      - Material specified from library
      - Material meets design requirements (strength, corrosion)
      - Compliance with applicable codes (ASME, AWS, AISC, etc.)
      - Surface finish requirements specified
      - Heat treatment if required
      
      **4. Documentation**
      - Engineering drawing with all views
      - GD&T callouts per ASME Y14.5
      - BOM with part numbers and quantities
      - Custom properties: PartNo, Description, Material, Revision
      - Revision history in drawing title block
      
      **5. Assembly Checks (if applicable)**
      - All mates/joints fully constrained
      - No over-defined mates
      - Fasteners sized correctly
      - Clearances for assembly/disassembly
      - Motion simulation if mechanisms present
      
      **Example Output:**
      ```json
      {
        "design_validation": {
          "part_info": {
            "part_number": "FL-6-150-RFWN",
            "revision": "A",
            "material": "ASTM A105",
            "mass_kg": 12.5,
            "volume_cm3": 1562
          },
          "geometry_checks": {
            "fully_defined_sketches": true,
            "no_rebuild_errors": true,
            "no_interference": true,
            "draft_analysis_passed": null
          },
          "manufacturing_checks": {
            "minimum_wall_thickness_ok": true,
            "all_holes_have_clearance": true,
            "threads_are_standard": true,
            "fillets_manufacturable": true,
            "tolerances_achievable": true
          },
          "standards_compliance": {
            "material_standard": "ASTM A105",
            "drawing_standard": "ASME Y14.5",
            "weld_standard": "ASME B16.5",
            "pressure_code": "ASME B16.5 Class 150"
          },
          "documentation": {
            "drawing_exists": true,
            "bom_complete": true,
            "custom_properties_filled": true,
            "revision_notes": "Initial release for ACHE project"
          },
          "issues": [
            {
              "severity": "warning",
              "category": "documentation",
              "description": "Surface finish not specified on flange face",
              "recommendation": "Add surface finish callout: 125-250 Ra per ASME B16.5"
            }
          ],
          "approval_status": "approved",
          "approver_notes": "Approved for fabrication. Add surface finish per issue #1."
        }
      }
      ```
    variables:
      - cad_file
      - min_wall_thickness
    tags:
      - validation
      - checklist
      - quality
      - structured
      - cad
    model_hint: "claude-sonnet-4"
    temperature: 0.1
    max_tokens: 2048

  - id: "cad.troubleshooting_assistant"
    name: "CAD Troubleshooting Assistant"
    description: "Diagnose and fix common CAD software errors and issues"
    type: "react"
    category: "debugging"
    content: |
      You are a CAD troubleshooting expert. Help diagnose and resolve ${error_description} in ${cad_software}.
      
      Use the ReAct pattern (Reasoning + Acting):
      
      **Step 1: Gather Information**
      ```json
      {
        "thought": "I need to understand the exact error and context",
        "action": {
          "command": "ask_user",
          "question": "What is the exact error message? When does it occur? What were you doing before the error?"
        }
      }
      ```
      
      **Step 2: Analyze**
      ```json
      {
        "observation": "User reports 'Rebuild Error: Sketch2 - Over-defined' in SolidWorks when adding dimensions",
        "thought": "Over-defined sketch means redundant constraints or dimensions. Need to identify conflicting constraints.",
        "action": {
          "command": "check_sketch_relations",
          "sketch_name": "Sketch2"
        }
      }
      ```
      
      **Step 3: Diagnose**
      ```json
      {
        "observation": "Sketch has 2 horizontal constraints and 1 dimension locking horizontal length",
        "thought": "The horizontal dimension conflicts with the automatic horizontal relation. One must be removed.",
        "action": {
          "command": "propose_fix",
          "fix_description": "Delete one of the horizontal relations, keep dimension"
        }
      }
      ```
      
      **Step 4: Implement**
      ```json
      {
        "action": {
          "command": "execute_fix",
          "steps": [
            "1. Right-click Sketch2 → Edit Sketch",
            "2. Select Display/Delete Relations",
            "3. Find duplicate Horizontal relation",
            "4. Delete extra relation",
            "5. Exit sketch - error should be resolved"
          ]
        }
      }
      ```
      
      **Step 5: Verify**
      ```json
      {
        "action": {
          "command": "verify_fix",
          "checks": [
            "Feature tree shows no errors (yellow/red flags)",
            "Sketch is fully defined (black lines)",
            "Part rebuilds without errors"
          ]
        }
      }
      ```
      
      **Common CAD Issues & Fixes:**
      
      **SolidWorks:**
      
      | Error | Cause | Fix |
      |-------|-------|-----|
      | "Rebuild Error" | Feature parameters invalid | Check dimensions, references |
      | "Over-defined sketch" | Redundant constraints/dims | Delete extra constraints |
      | "Dangling dimensions" | Referenced geometry deleted | Reattach or delete dims |
      | "What's Wrong?" errors | API/macro issues | Rebuild feature tree, restart SW |
      | "Out of context" (assembly) | External references broken | Edit In-Context or break reference |
      | "Interference detected" | Parts overlapping | Adjust mates, move components |
      
      **Inventor:**
      
      | Error | Cause | Fix |
      |-------|-------|-----|
      | "Sketch not fully constrained" | Under-defined geometry | Add dimensions/constraints |
      | "Feature failed" | Invalid parameters | Check extrude depth, profile |
      | "Cannot create work feature" | Reference geometry missing | Create work planes/axes first |
      | "Assembly constraints failed" | Over-constrained | Remove redundant joints |
      | "iMate definition conflict" | Duplicate iMates on same face | Delete/redefine iMates |
      | "Flat pattern failed" | Bend too sharp, relief too small | Increase bend radius, relief size |
      
      **Performance Issues:**
      
      | Symptom | Cause | Fix |
      |---------|-------|-----|
      | Slow rebuild | Large assembly, complex parts | Use SpeedPak/LOD, simplify parts |
      | Crashes on save | Corrupt file or insufficient memory | Save As new file, increase RAM |
      | Graphics glitches | Outdated GPU drivers | Update graphics drivers |
      | Slow rotation | High poly surfaces, RealView on | Disable RealView, lower quality |
      
      **Diagnostic Commands:**
      
      **SolidWorks:**
      - Tools → Evaluate → Check to find geometry errors
      - FeatureWorks → Recognize Features to analyze imported geometry
      - Tools → Add-Ins → Design Doctor for automated fixes
      
      **Inventor:**
      - Inspect tab → Design Doctor for feature errors
      - File → Compact to clean up file size
      - Tools → Application Options → Graphics to adjust performance
      
      Now diagnose and fix: ${error_description}
    variables:
      - error_description
      - cad_software
    tags:
      - troubleshooting
      - debugging
      - cad
      - react
      - error-fixing
    model_hint: "claude-sonnet-4"
    temperature: 0.3
    max_tokens: 3000
